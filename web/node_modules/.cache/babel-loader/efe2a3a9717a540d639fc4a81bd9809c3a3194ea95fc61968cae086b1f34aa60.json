{"ast":null,"code":"import \"core-js/modules/es.array.push.js\";\nimport AMapLoader from \"@amap/amap-jsapi-loader\";\nimport { getOptions, getMarkers } from \"../../api/request.js\";\nexport default {\n  name: \"map-view\",\n  data() {\n    return {\n      optionsList: []\n    };\n  },\n  mounted() {\n    this.initAMap();\n  },\n  unmounted() {\n    this.map?.destroy();\n  },\n  async created() {\n    if (this.$route.name !== 'schoolMap') {\n      this.$store.commit(\"setBreadList\", [{\n        title: '地图管理'\n      }, {\n        title: '预览'\n      }]);\n    }\n    console.log('asd', this.$store.state.location);\n    await getMarkers().then(res => {\n      this.markersList = res.data.data;\n    });\n  },\n  methods: {\n    initAMap() {\n      const that = this;\n      AMapLoader.load({\n        key: \"a05ab04a5dbe61ad2fad7b664790a18f\",\n        // 申请好的Web端开发者Key，首次调用 load 时必填\n        version: \"2.0\",\n        // 指定要加载的 JSAPI 的版本，缺省时默认为 1.4.15\n        plugins: [] // 需要使用的的插件列表，如比例尺'AMap.Scale'等\n      }).then(AMap => {\n        this.map = new AMap.Map(\"container\", {\n          // 设置地图容器id\n          viewMode: \"2D\",\n          // 是否为3D地图模式\n          zoom: 14,\n          // 初始化地图级别\n          center: [118.28752699999995, 35.12255099999999] // 初始化地图中心点位置\n        });\n        this.map.plugin('AMap.Geolocation', function () {\n          var geolocation = new AMap.Geolocation({\n            enableHighAccuracy: true,\n            // 是否使用高精度定位，默认：true\n            timeout: 10000,\n            // 设置定位超时时间，默认：无穷大\n            offset: [10, 20],\n            // 定位按钮的停靠位置的偏移量\n            zoomToAccuracy: true,\n            //  定位成功后调整地图视野范围使定位位置及精度范围视野内可见，默认：false\n            position: 'RB' //  定位按钮的排放位置,  RB表示右下\n          });\n          geolocation.getCurrentPosition(function (status, result) {\n            if (status == 'complete') {\n              onComplete(result);\n            } else {\n              onError(result);\n            }\n          });\n          function onComplete(data) {\n            // data是具体的定位信息\n            console.log('经纬度', data.position);\n            that.$store.commit('updateLocation', data.position);\n            localStorage.setItem('myLocation', JSON.stringify(data.position));\n          }\n          function onError(data) {\n            // 定位出错\n            if (data.message.includes(\"permission denied\")) {\n              console.log('定位权限被拒绝，请检查浏览器设置。', data);\n            } else {\n              console.log('定位失败', data);\n            }\n          }\n        });\n        const marker = new AMap.Marker({\n          position: new AMap.LngLat(118.28752699999995, 35.12255099999999),\n          //经纬度对象，也可以是经纬度构成的一维数组[116.39, 39.9]\n          title: \"临沂大学\"\n        });\n        this.map.add(marker);\n        getOptions().then(res => {\n          this.optionsList = res.data.data;\n          console.log('zuobiap', this.optionsList);\n          let path = [];\n          that.optionsList.map(iem => {\n            path.push(new AMap.LngLat(iem.lat, iem.lng));\n          });\n          var polygon = new AMap.Polygon({\n            path: path,\n            fillColor: '#fff',\n            // 多边形填充颜色\n            borderWeight: 2,\n            // 线条宽度，默认为 1\n            strokeColor: 'red' // 线条颜色\n          });\n          this.map.add(polygon);\n          console.log(this.map);\n        });\n      }).catch(e => {\n        console.log(e);\n      });\n    }\n  }\n};","map":{"version":3,"names":["AMapLoader","getOptions","getMarkers","name","data","optionsList","mounted","initAMap","unmounted","map","destroy","created","$route","$store","commit","title","console","log","state","location","then","res","markersList","methods","that","load","key","version","plugins","AMap","Map","viewMode","zoom","center","plugin","geolocation","Geolocation","enableHighAccuracy","timeout","offset","zoomToAccuracy","position","getCurrentPosition","status","result","onComplete","onError","localStorage","setItem","JSON","stringify","message","includes","marker","Marker","LngLat","add","path","iem","push","lat","lng","polygon","Polygon","fillColor","borderWeight","strokeColor","catch","e"],"sources":["C:\\Users\\Administrator\\Desktop\\ershou\\src\\components\\mapmanage\\MapContainer.vue"],"sourcesContent":["<template>\n  <div id=\"container\"></div>\n</template>\n<script>\nimport AMapLoader from \"@amap/amap-jsapi-loader\";\nimport { getOptions, getMarkers } from \"../../api/request.js\";\nexport default {\n  name: \"map-view\",\n  data() {\n    return {\n      optionsList: []\n    }\n  },\n  mounted() {\n    this.initAMap();\n  },\n  unmounted() {\n    this.map?.destroy();\n  },\n  async created() {\n    if (this.$route.name !== 'schoolMap') {\n      this.$store.commit(\"setBreadList\", [{ title: '地图管理' }, { title: '预览' }]);\n    }\n    console.log('asd', this.$store.state.location);\n    await getMarkers().then((res) => {\n      this.markersList = res.data.data\n    })\n  },\n  methods: {\n    initAMap() {\n      const that = this;\n      AMapLoader.load({\n        key: \"a05ab04a5dbe61ad2fad7b664790a18f\", // 申请好的Web端开发者Key，首次调用 load 时必填\n        version: \"2.0\", // 指定要加载的 JSAPI 的版本，缺省时默认为 1.4.15\n        plugins: [], // 需要使用的的插件列表，如比例尺'AMap.Scale'等\n      })\n        .then((AMap) => {\n          this.map = new AMap.Map(\"container\", {\n            // 设置地图容器id\n            viewMode: \"2D\", // 是否为3D地图模式\n            zoom: 14, // 初始化地图级别\n            center: [118.28752699999995, 35.12255099999999], // 初始化地图中心点位置\n          });\n          this.map.plugin('AMap.Geolocation', function () {\n            var geolocation = new AMap.Geolocation({\n              enableHighAccuracy: true, // 是否使用高精度定位，默认：true\n              timeout: 10000, // 设置定位超时时间，默认：无穷大\n              offset: [10, 20],  // 定位按钮的停靠位置的偏移量\n              zoomToAccuracy: true,  //  定位成功后调整地图视野范围使定位位置及精度范围视野内可见，默认：false\n              position: 'RB' //  定位按钮的排放位置,  RB表示右下\n            })\n\n            geolocation.getCurrentPosition(function (status, result) {\n              if (status == 'complete') {\n                onComplete(result)\n              } else {\n                onError(result)\n              }\n            });\n\n            function onComplete(data) {\n              // data是具体的定位信息\n              console.log('经纬度', data.position);\n              that.$store.commit('updateLocation', data.position)\n              localStorage.setItem('myLocation', JSON.stringify(data.position))\n            }\n\n            function onError(data) {\n              // 定位出错\n              if (data.message.includes(\"permission denied\")) {\n                console.log('定位权限被拒绝，请检查浏览器设置。', data);\n              } else {\n                console.log('定位失败', data);\n              }\n            }\n          })\n          const marker = new AMap.Marker({\n            position: new AMap.LngLat(118.28752699999995, 35.12255099999999), //经纬度对象，也可以是经纬度构成的一维数组[116.39, 39.9]\n            title: \"临沂大学\",\n          });\n          this.map.add(marker);\n          getOptions().then((res) => {\n            this.optionsList = res.data.data\n            console.log('zuobiap', this.optionsList);\n            let path = []\n            that.optionsList.map(iem => {\n              path.push(new AMap.LngLat(iem.lat, iem.lng))\n            })\n            var polygon = new AMap.Polygon({\n              path: path,\n              fillColor: '#fff', // 多边形填充颜色\n              borderWeight: 2, // 线条宽度，默认为 1\n              strokeColor: 'red', // 线条颜色\n            });\n\n            this.map.add(polygon);\n            console.log(this.map);\n          })\n        })\n        .catch((e) => {\n          console.log(e);\n        });\n    },\n  },\n};\n</script>\n<style scoped>\n#container {\n  width: 100%;\n  height: 600px;\n  max-height: 100%;\n}\n</style>\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}