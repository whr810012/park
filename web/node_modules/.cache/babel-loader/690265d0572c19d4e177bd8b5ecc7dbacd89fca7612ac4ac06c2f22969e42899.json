{"ast":null,"code":"import { getAllPark, addPark, deletePark, updatePark, getAllArea } from '@/api/request';\nimport dayjs from 'dayjs';\nexport default {\n  data() {\n    return {\n      tableData: [],\n      currentPage: 1,\n      areaList: [],\n      addShow: false,\n      newForm: {\n        areaid: '',\n        createName: \"\",\n        createTime: \"\",\n        location: \"\",\n        price: 0,\n        stallId: 0,\n        status: 0\n      },\n      editShow: false,\n      editForm: {}\n    };\n  },\n  computed: {\n    tableDataFilter() {\n      return this.tableData.slice((this.currentPage - 1) * 10, this.currentPage * 10);\n    }\n  },\n  methods: {\n    closeDia() {\n      this.addShow = false;\n      this.editShow = false;\n      this.editForm = {};\n      this.newForm = {\n        areaid: '',\n        createName: \"\",\n        createTime: \"\",\n        location: \"\",\n        price: 0,\n        stallId: 0,\n        status: 0\n      };\n    },\n    editDia(item) {\n      this.editShow = true;\n      this.editForm = item;\n    },\n    editStall() {\n      const data = {\n        areaid: this.editForm.areaid,\n        createName: this.editForm.createName,\n        createTime: dayjs(this.editForm.createTime).format('YYYY-MM-DDTHH:mm:ss'),\n        location: this.editForm.location,\n        price: this.editForm.price,\n        stallId: this.editForm.stallId,\n        status: this.editForm.status\n      };\n      updatePark(data).then(() => {\n        this.$notify({\n          title: '成功',\n          message: '修改成功',\n          type: 'success'\n        });\n        this.closeDia();\n        this.init();\n      });\n    },\n    addStall() {\n      const data = {\n        areaid: this.newForm.areaid,\n        createName: this.$store.state.MyInfo.email,\n        createTime: dayjs(new Date()).format('YYYY-MM-DDTHH:mm:ss'),\n        location: this.newForm.location,\n        price: this.newForm.price,\n        stallId: Math.floor(Date.now() / 1000) + Math.floor(Math.random() * 1000),\n        status: 0\n      };\n      addPark(data).then(() => {\n        this.$notify({\n          title: '成功',\n          message: '添加成功',\n          type: 'success'\n        });\n        this.closeDia();\n        this.init();\n      });\n    },\n    deletePark(row) {\n      this.$confirm('确定删除该车位吗？', '提示', {\n        confirmButtonText: '确定',\n        cancelButtonText: '取消',\n        type: 'warning'\n      }).then(() => {\n        deletePark([row.stallId]).then(() => {\n          this.$message.success('删除成功');\n          this.init();\n        });\n      });\n    },\n    init() {\n      getAllPark().then(res => {\n        this.tableData = res.data.data;\n        getAllArea().then(area => {\n          this.areaList = area.data.data;\n          this.tableData.forEach(item => {\n            item.createTime = dayjs(item.createTime).format('YYYY-MM-DD HH:mm:ss');\n            this.areaList.map(area => {\n              if (item.areaid === area.areaid) {\n                item.areaName = area.areaName;\n              }\n            });\n          });\n        });\n      });\n    }\n  },\n  created() {\n    this.init();\n  }\n};","map":{"version":3,"names":["getAllPark","addPark","deletePark","updatePark","getAllArea","dayjs","data","tableData","currentPage","areaList","addShow","newForm","areaid","createName","createTime","location","price","stallId","status","editShow","editForm","computed","tableDataFilter","slice","methods","closeDia","editDia","item","editStall","format","then","$notify","title","message","type","init","addStall","$store","state","MyInfo","email","Date","Math","floor","now","random","row","$confirm","confirmButtonText","cancelButtonText","$message","success","res","area","forEach","map","areaName","created"],"sources":["D:\\CODE\\park\\park-vue\\web\\src\\pages\\home\\stallManage.vue"],"sourcesContent":["<template>\r\n  <div class=\"area-manage\" style=\"padding: 20px\">\r\n    <el-button type=\"primary\" @click=\"addShow = true\">新增车位</el-button>\r\n    <el-table :data=\"tableDataFilter\" style=\"width: 100%; margin-top: 20px\" border>\r\n      <el-table-column prop=\"stallId\" label=\"车位编号\"></el-table-column>\r\n      <el-table-column prop=\"areaName\" label=\"所在区域\"></el-table-column>\r\n      <el-table-column prop=\"location\" label=\"具体位置\"></el-table-column>\r\n      <el-table-column prop=\"price\" label=\"价格\">\r\n        <template #default=\"scope\">\r\n          {{ scope.row.price }}元/小时\r\n        </template>\r\n      </el-table-column>\r\n      <el-table-column prop=\"status\" label=\"车位状态\">\r\n        <template #default=\"scope\">\r\n          <el-tag type=\"success\" v-if=\"scope.row.status === 0\">空闲</el-tag>\r\n          <el-tag type=\"warning\" v-if=\"scope.row.status === 1\">已预定</el-tag>\r\n          <el-tag type=\"error\" v-if=\"scope.row.status === 2\">已停车</el-tag>\r\n        </template>\r\n      </el-table-column>\r\n      <el-table-column prop=\"createTime\" label=\"创建时间\"></el-table-column>\r\n      <el-table-column prop=\"createName\" label=\"创建人\"></el-table-column>\r\n      <el-table-column label=\"操作\" align=\"center\" width=\"150px\">\r\n        <template #default=\"scope\">\r\n          <el-button type=\"text\" size=\"small\" @click=\"editDia(scope.row)\">编辑</el-button>\r\n          <el-button type=\"text\" size=\"small\" @click=\"deletePark(scope.row)\">删除</el-button>\r\n        </template>\r\n      </el-table-column>\r\n    </el-table>\r\n    <div style=\"margin-top: 20px\">\r\n      <el-pagination background layout=\"prev, pager, next\" :total=\"tableData.length\"\r\n        v-model:current-page=\"currentPage\"></el-pagination>\r\n    </div>\r\n    <el-dialog v-if=\"addShow\" v-model=\"addShow\" title=\"新增车位\" @close=\"closeDia\">\r\n      <el-form :data=\"newForm\" label-width=\"100px\">\r\n        <el-form-item name=\"areaid\" label=\"所在区域:\">\r\n          <el-select v-model=\"newForm.areaid\">\r\n            <el-option v-for=\"item in areaList\" :key=\"item.areaid\" :label=\"item.areaName\"\r\n              :value=\"item.areaid\"></el-option>\r\n          </el-select>\r\n        </el-form-item>\r\n        <el-form-item name=\"location\" label=\"具体位置:\">\r\n          <el-input v-model=\"newForm.location\"></el-input>\r\n        </el-form-item>\r\n        <el-form-item name=\"price\" label=\"价格:\">\r\n          <el-input-number min=\"0\" v-model=\"newForm.price\"></el-input-number>\r\n        </el-form-item>\r\n        <el-form-item name=\"images\" label=\"车位照片\">\r\n          <el-upload>\r\n            \r\n          </el-upload>\r\n        </el-form-item>\r\n        <div>\r\n          <el-button @click=\"closeDia\">取消</el-button>\r\n          <el-button type=\"primary\" @click=\"addStall\">\r\n            确认\r\n          </el-button>\r\n        </div>\r\n      </el-form>\r\n    </el-dialog>\r\n    <el-dialog v-if=\"editShow\" v-model=\"editShow\" title=\"编辑车位\" @close=\"closeDia\">\r\n      <el-form :data=\"editForm\" label-width=\"100px\">\r\n        <el-form-item name=\"areaid\" label=\"所在区域:\">\r\n          <el-select v-model=\"editForm.areaid\">\r\n            <el-option v-for=\"item in areaList\" :key=\"item.areaid\" :label=\"item.areaName\"\r\n              :value=\"item.areaid\"></el-option>\r\n          </el-select>\r\n        </el-form-item>\r\n        <el-form-item name=\"location\" label=\"具体位置:\">\r\n          <el-input v-model=\"editForm.location\"></el-input>\r\n        </el-form-item>\r\n        <el-form-item name=\"price\" label=\"价格:\">\r\n          <el-input-number min=\"0\" v-model=\"editForm.price\"></el-input-number>\r\n        </el-form-item>\r\n        <div>\r\n          <el-button @click=\"closeDia\">取消</el-button>\r\n          <el-button type=\"primary\" @click=\"editStall\">\r\n            确认\r\n          </el-button>\r\n        </div>\r\n      </el-form>\r\n    </el-dialog>\r\n  </div>\r\n</template>\r\n\r\n<script>\r\nimport { getAllPark, addPark, deletePark, updatePark, getAllArea } from '@/api/request'\r\nimport dayjs from 'dayjs'\r\nexport default {\r\n  data() {\r\n    return {\r\n      tableData: [\r\n      ],\r\n      currentPage: 1,\r\n      areaList: [],\r\n      addShow: false,\r\n      newForm: {\r\n        areaid: '',\r\n        createName: \"\",\r\n        createTime: \"\",\r\n        location: \"\",\r\n        price: 0,\r\n        stallId: 0,\r\n        status: 0\r\n      },\r\n      editShow: false,\r\n      editForm:{\r\n\r\n      }\r\n    }\r\n  },\r\n  computed: {\r\n    tableDataFilter() {\r\n      return this.tableData.slice((this.currentPage - 1) * 10, this.currentPage * 10)\r\n    }\r\n  },\r\n  methods: {\r\n    closeDia () {\r\n      this.addShow = false\r\n      this.editShow = false\r\n      this.editForm = {}\r\n      this.newForm = {\r\n        areaid: '',\r\n        createName: \"\",\r\n        createTime: \"\",\r\n        location: \"\",\r\n        price: 0,\r\n        stallId: 0,\r\n        status: 0\r\n      }\r\n    },\r\n    editDia (item) {\r\n      this.editShow = true\r\n      this.editForm = item\r\n    },\r\n    editStall () {\r\n      const data = {\r\n        areaid: this.editForm.areaid,\r\n        createName: this.editForm.createName,\r\n        createTime: dayjs(this.editForm.createTime).format('YYYY-MM-DDTHH:mm:ss'),\r\n        location: this.editForm.location,\r\n        price: this.editForm.price,\r\n        stallId: this.editForm.stallId,\r\n        status: this.editForm.status\r\n      }\r\n      updatePark(data).then(() => {\r\n        this.$notify({\r\n          title: '成功',\r\n          message: '修改成功',\r\n          type: 'success'\r\n        })\r\n        this.closeDia()\r\n        this.init()\r\n      })\r\n    },\r\n    addStall () {\r\n      const data = {\r\n        areaid: this.newForm.areaid,\r\n        createName: this.$store.state.MyInfo.email,\r\n        createTime: dayjs(new Date()).format('YYYY-MM-DDTHH:mm:ss'),\r\n        location: this.newForm.location,\r\n        price: this.newForm.price,\r\n        stallId: Math.floor(Date.now() / 1000) + Math.floor(Math.random() * 1000),\r\n        status: 0\r\n      }\r\n      addPark(data).then(() => {\r\n        this.$notify({\r\n          title: '成功',\r\n          message: '添加成功',\r\n          type: 'success'\r\n        })\r\n        this.closeDia()\r\n        this.init()\r\n      })\r\n    },\r\n    deletePark(row) {\r\n      this.$confirm('确定删除该车位吗？', '提示', {\r\n        confirmButtonText: '确定',\r\n        cancelButtonText: '取消',\r\n        type: 'warning'\r\n      }).then(() => {\r\n        deletePark([row.stallId]).then(() => {\r\n          this.$message.success('删除成功')\r\n          this.init()\r\n        })\r\n      })\r\n    },\r\n    init() {\r\n      getAllPark().then(res => {\r\n        this.tableData = res.data.data\r\n        getAllArea().then(area => {\r\n          this.areaList = area.data.data\r\n          this.tableData.forEach(item => {\r\n            item.createTime = dayjs(item.createTime).format('YYYY-MM-DD HH:mm:ss')\r\n            this.areaList.map(area => {\r\n              if (item.areaid === area.areaid) {\r\n                item.areaName = area.areaName\r\n              }\r\n            })\r\n          })\r\n        })\r\n      })\r\n    }\r\n  },\r\n  created() {\r\n    this.init()\r\n  }\r\n}\r\n</script>\r\n\r\n<style></style>"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}