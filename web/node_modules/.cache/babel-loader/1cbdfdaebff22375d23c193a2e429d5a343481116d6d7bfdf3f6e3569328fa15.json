{"ast":null,"code":"import AMapLoader from \"@amap/amap-jsapi-loader\";\nimport { getGoodsDetail } from '@/api/request';\nimport { space } from '@/utils/utils';\nexport default {\n  data() {\n    return {\n      goodsDetail: {}\n    };\n  },\n  components: {},\n  computed: {\n    goodsId() {\n      return this.$route.query.goodsId;\n    },\n    distance() {\n      const myLocation = localStorage.getItem('myLocation');\n      if (!myLocation) {\n        this.getMyMAP();\n        myLocation = localStorage.getItem('myLocation');\n      }\n      console.log(this.goodsDetail.lat, this.goodsDetail.lng, myLocation[1], myLocation[0]);\n      return space(this.goodsDetail.lat, this.goodsDetail.lng, myLocation[1], myLocation[0]);\n    }\n  },\n  methods: {\n    getMyMAP() {\n      AMapLoader.load({\n        key: \"a05ab04a5dbe61ad2fad7b664790a18f\",\n        // 申请好的Web端开发者Key，首次调用 load 时必填\n        version: \"2.0\",\n        // 指定要加载的 JSAPI 的版本，缺省时默认为 1.4.15\n        plugins: [] // 需要使用的的插件列表，如比例尺'AMap.Scale'等\n      }).then(AMap => {\n        this.map = new AMap.Map(\"container\", {\n          // 设置地图容器id\n          viewMode: \"2D\",\n          // 是否为3D地图模式\n          zoom: 14,\n          // 初始化地图级别\n          center: [118.28752699999995, 35.12255099999999] // 初始化地图中心点位置\n        });\n        this.map.plugin('AMap.Geolocation', function () {\n          geolocation.getCurrentPosition(function (status, result) {\n            if (status == 'complete') {\n              onComplete(result);\n            } else {\n              onError(result);\n            }\n          });\n          function onComplete(data) {\n            // data是具体的定位信息\n            console.log('经纬度', data.position);\n            that.$store.commit('updateLocation', data.position);\n            localStorage.setItem('myLocation', JSON.stringify(data.position));\n          }\n          function onError(data) {\n            // 定位出错\n            if (data.message.includes(\"permission denied\")) {\n              console.log('定位权限被拒绝，请检查浏览器设置。', data);\n            } else {\n              console.log('定位失败', data);\n            }\n          }\n        });\n        const marker = new AMap.Marker({\n          position: new AMap.LngLat(118.28752699999995, 35.12255099999999),\n          //经纬度对象，也可以是经纬度构成的一维数组[116.39, 39.9]\n          title: \"临沂大学\"\n        });\n      }).catch(e => {\n        console.log(e);\n      });\n    }\n  },\n  created() {\n    console.log(this.goodsId);\n    getGoodsDetail({\n      goodsId: this.goodsId\n    }).then(res => {\n      this.goodsDetail = res.data.data;\n      console.log(res.data.data);\n      this.goodsDetail.filesJson = JSON.parse(res.data.data.filesJson);\n      console.log(this.goodsDetail.filesJson);\n      this.goodsDetail.filesJson.forEach(img => {\n        const mimeType = img.contentType;\n        img.url = `data:${mimeType};base64,${img.base64}`;\n      });\n      console.log(this.goodsDetail.filesJson);\n    });\n  }\n};","map":{"version":3,"names":["AMapLoader","getGoodsDetail","space","data","goodsDetail","components","computed","goodsId","$route","query","distance","myLocation","localStorage","getItem","getMyMAP","console","log","lat","lng","methods","load","key","version","plugins","then","AMap","map","Map","viewMode","zoom","center","plugin","geolocation","getCurrentPosition","status","result","onComplete","onError","position","that","$store","commit","setItem","JSON","stringify","message","includes","marker","Marker","LngLat","title","catch","e","created","res","filesJson","parse","forEach","img","mimeType","contentType","url","base64"],"sources":["C:\\Users\\Administrator\\Desktop\\ershou\\src\\pages\\goods\\buyGoods.vue"],"sourcesContent":["<template>\r\n    <div class=\"buyGoods\">\r\n        <el-carousel indicator-position=\"outside\" type=\"card\">\r\n            <el-carousel-item v-for=\"item in this.goodsDetail.filesJson\" :key=\"item\">\r\n                <!-- 原来尺寸大小展示 -->\r\n                <el-image style=\"width: 100%; height: 100%\" fit=\"contain\" :src=\"item.url\"></el-image>\r\n            </el-carousel-item>\r\n        </el-carousel>\r\n        <div class=\"goodsInfo\">\r\n            <div class=\"title\">{{ goodsDetail.name }}</div>\r\n            <div>原价：{{ goodsDetail.price }}</div>\r\n            <div v-vif=\"goodsDetail.discount != 1\">折扣：{{ goodsDetail.discount }}</div>\r\n            <div v-if=\"goodsDetail.discount != 1\">现价：{{ (goodsDetail.price * (goodsDetail.discount * 100)) / 100 }}</div>\r\n            <div>成色：{{ goodsDetail.condition }}</div>\r\n            <div>描述：{{ goodsDetail.description }}</div>\r\n            <div>交易地点：{{ goodsDetail.address }}</div>\r\n            <div>距离：{{ distance }}</div>\r\n        </div>\r\n    </div>\r\n</template>\r\n\r\n<script>\r\nimport AMapLoader from \"@amap/amap-jsapi-loader\";\r\nimport { getGoodsDetail } from '@/api/request'\r\nimport { space } from '@/utils/utils'\r\nexport default {\r\n    data() {\r\n        return {\r\n            goodsDetail: {}\r\n        }\r\n    },\r\n    components: {\r\n\r\n    },\r\n    computed: {\r\n        goodsId() {\r\n            return this.$route.query.goodsId\r\n        },\r\n        distance() {\r\n            const myLocation = localStorage.getItem('myLocation')\r\n            if (!myLocation) {\r\n                this.getMyMAP()\r\n                myLocation = localStorage.getItem('myLocation')\r\n            }\r\n            console.log(this.goodsDetail.lat, this.goodsDetail.lng, myLocation[1], myLocation[0]);\r\n            return space(this.goodsDetail.lat, this.goodsDetail.lng, myLocation[1], myLocation[0])\r\n        }\r\n    },\r\n    methods: {\r\n        getMyMAP() {\r\n            AMapLoader.load({\r\n                key: \"a05ab04a5dbe61ad2fad7b664790a18f\", // 申请好的Web端开发者Key，首次调用 load 时必填\r\n                version: \"2.0\", // 指定要加载的 JSAPI 的版本，缺省时默认为 1.4.15\r\n                plugins: [], // 需要使用的的插件列表，如比例尺'AMap.Scale'等\r\n            })\r\n                .then((AMap) => {\r\n                    this.map = new AMap.Map(\"container\", {\r\n                        // 设置地图容器id\r\n                        viewMode: \"2D\", // 是否为3D地图模式\r\n                        zoom: 14, // 初始化地图级别\r\n                        center: [118.28752699999995, 35.12255099999999], // 初始化地图中心点位置\r\n                    });\r\n                    this.map.plugin('AMap.Geolocation', function () {\r\n\r\n                        geolocation.getCurrentPosition(function (status, result) {\r\n                            if (status == 'complete') {\r\n                                onComplete(result)\r\n                            } else {\r\n                                onError(result)\r\n                            }\r\n                        });\r\n\r\n                        function onComplete(data) {\r\n                            // data是具体的定位信息\r\n                            console.log('经纬度', data.position);\r\n                            that.$store.commit('updateLocation', data.position)\r\n                            localStorage.setItem('myLocation', JSON.stringify(data.position))\r\n                        }\r\n\r\n                        function onError(data) {\r\n                            // 定位出错\r\n                            if (data.message.includes(\"permission denied\")) {\r\n                                console.log('定位权限被拒绝，请检查浏览器设置。', data);\r\n                            } else {\r\n                                console.log('定位失败', data);\r\n                            }\r\n                        }\r\n                    })\r\n                    const marker = new AMap.Marker({\r\n                        position: new AMap.LngLat(118.28752699999995, 35.12255099999999), //经纬度对象，也可以是经纬度构成的一维数组[116.39, 39.9]\r\n                        title: \"临沂大学\",\r\n                    })\r\n                })\r\n                .catch((e) => {\r\n                    console.log(e)\r\n                });\r\n        }\r\n    },\r\n    created() {\r\n        console.log(this.goodsId);\r\n        getGoodsDetail({ goodsId: this.goodsId }).then(res => {\r\n            this.goodsDetail = res.data.data\r\n            console.log(res.data.data);\r\n            this.goodsDetail.filesJson = JSON.parse(res.data.data.filesJson)\r\n            console.log(this.goodsDetail.filesJson);\r\n            this.goodsDetail.filesJson.forEach(img => {\r\n                const mimeType = img.contentType\r\n                img.url = `data:${mimeType};base64,${img.base64}`;\r\n            })\r\n            console.log(this.goodsDetail.filesJson)\r\n        })\r\n    }\r\n}\r\n</script>\r\n\r\n<style lang=\"scss\" scoped>\r\n.goodsInfo {\r\n    padding: 20px;\r\n    background-color: #f5f5f5;\r\n\r\n    .title {\r\n        color: #11192d;\r\n        font-family: PingFangSC-Semibold;\r\n        font-size: 20px;\r\n        font-weight: 600;\r\n        letter-spacing: 0;\r\n        line-height: 30px;\r\n        -webkit-line-clamp: 2;\r\n        -webkit-box-orient: vertical;\r\n        display: -webkit-box;\r\n    }\r\n}\r\n</style>"],"mappings":"AAsBA,OAAOA,UAAS,MAAO,yBAAyB;AAChD,SAASC,cAAa,QAAS,eAAc;AAC7C,SAASC,KAAI,QAAS,eAAc;AACpC,eAAe;EACXC,IAAIA,CAAA,EAAG;IACH,OAAO;MACHC,WAAW,EAAE,CAAC;IAClB;EACJ,CAAC;EACDC,UAAU,EAAE,CAEZ,CAAC;EACDC,QAAQ,EAAE;IACNC,OAAOA,CAAA,EAAG;MACN,OAAO,IAAI,CAACC,MAAM,CAACC,KAAK,CAACF,OAAM;IACnC,CAAC;IACDG,QAAQA,CAAA,EAAG;MACP,MAAMC,UAAS,GAAIC,YAAY,CAACC,OAAO,CAAC,YAAY;MACpD,IAAI,CAACF,UAAU,EAAE;QACb,IAAI,CAACG,QAAQ,CAAC;QACdH,UAAS,GAAIC,YAAY,CAACC,OAAO,CAAC,YAAY;MAClD;MACAE,OAAO,CAACC,GAAG,CAAC,IAAI,CAACZ,WAAW,CAACa,GAAG,EAAE,IAAI,CAACb,WAAW,CAACc,GAAG,EAAEP,UAAU,CAAC,CAAC,CAAC,EAAEA,UAAU,CAAC,CAAC,CAAC,CAAC;MACrF,OAAOT,KAAK,CAAC,IAAI,CAACE,WAAW,CAACa,GAAG,EAAE,IAAI,CAACb,WAAW,CAACc,GAAG,EAAEP,UAAU,CAAC,CAAC,CAAC,EAAEA,UAAU,CAAC,CAAC,CAAC;IACzF;EACJ,CAAC;EACDQ,OAAO,EAAE;IACLL,QAAQA,CAAA,EAAG;MACPd,UAAU,CAACoB,IAAI,CAAC;QACZC,GAAG,EAAE,kCAAkC;QAAE;QACzCC,OAAO,EAAE,KAAK;QAAE;QAChBC,OAAO,EAAE,EAAE,CAAE;MACjB,CAAC,EACIC,IAAI,CAAEC,IAAI,IAAK;QACZ,IAAI,CAACC,GAAE,GAAI,IAAID,IAAI,CAACE,GAAG,CAAC,WAAW,EAAE;UACjC;UACAC,QAAQ,EAAE,IAAI;UAAE;UAChBC,IAAI,EAAE,EAAE;UAAE;UACVC,MAAM,EAAE,CAAC,kBAAkB,EAAE,iBAAiB,CAAC,CAAE;QACrD,CAAC,CAAC;QACF,IAAI,CAACJ,GAAG,CAACK,MAAM,CAAC,kBAAkB,EAAE,YAAY;UAE5CC,WAAW,CAACC,kBAAkB,CAAC,UAAUC,MAAM,EAAEC,MAAM,EAAE;YACrD,IAAID,MAAK,IAAK,UAAU,EAAE;cACtBE,UAAU,CAACD,MAAM;YACrB,OAAO;cACHE,OAAO,CAACF,MAAM;YAClB;UACJ,CAAC,CAAC;UAEF,SAASC,UAAUA,CAACjC,IAAI,EAAE;YACtB;YACAY,OAAO,CAACC,GAAG,CAAC,KAAK,EAAEb,IAAI,CAACmC,QAAQ,CAAC;YACjCC,IAAI,CAACC,MAAM,CAACC,MAAM,CAAC,gBAAgB,EAAEtC,IAAI,CAACmC,QAAQ;YAClD1B,YAAY,CAAC8B,OAAO,CAAC,YAAY,EAAEC,IAAI,CAACC,SAAS,CAACzC,IAAI,CAACmC,QAAQ,CAAC;UACpE;UAEA,SAASD,OAAOA,CAAClC,IAAI,EAAE;YACnB;YACA,IAAIA,IAAI,CAAC0C,OAAO,CAACC,QAAQ,CAAC,mBAAmB,CAAC,EAAE;cAC5C/B,OAAO,CAACC,GAAG,CAAC,mBAAmB,EAAEb,IAAI,CAAC;YAC1C,OAAO;cACHY,OAAO,CAACC,GAAG,CAAC,MAAM,EAAEb,IAAI,CAAC;YAC7B;UACJ;QACJ,CAAC;QACD,MAAM4C,MAAK,GAAI,IAAItB,IAAI,CAACuB,MAAM,CAAC;UAC3BV,QAAQ,EAAE,IAAIb,IAAI,CAACwB,MAAM,CAAC,kBAAkB,EAAE,iBAAiB,CAAC;UAAE;UAClEC,KAAK,EAAE;QACX,CAAC;MACL,CAAC,EACAC,KAAK,CAAEC,CAAC,IAAK;QACVrC,OAAO,CAACC,GAAG,CAACoC,CAAC;MACjB,CAAC,CAAC;IACV;EACJ,CAAC;EACDC,OAAOA,CAAA,EAAG;IACNtC,OAAO,CAACC,GAAG,CAAC,IAAI,CAACT,OAAO,CAAC;IACzBN,cAAc,CAAC;MAAEM,OAAO,EAAE,IAAI,CAACA;IAAQ,CAAC,CAAC,CAACiB,IAAI,CAAC8B,GAAE,IAAK;MAClD,IAAI,CAAClD,WAAU,GAAIkD,GAAG,CAACnD,IAAI,CAACA,IAAG;MAC/BY,OAAO,CAACC,GAAG,CAACsC,GAAG,CAACnD,IAAI,CAACA,IAAI,CAAC;MAC1B,IAAI,CAACC,WAAW,CAACmD,SAAQ,GAAIZ,IAAI,CAACa,KAAK,CAACF,GAAG,CAACnD,IAAI,CAACA,IAAI,CAACoD,SAAS;MAC/DxC,OAAO,CAACC,GAAG,CAAC,IAAI,CAACZ,WAAW,CAACmD,SAAS,CAAC;MACvC,IAAI,CAACnD,WAAW,CAACmD,SAAS,CAACE,OAAO,CAACC,GAAE,IAAK;QACtC,MAAMC,QAAO,GAAID,GAAG,CAACE,WAAU;QAC/BF,GAAG,CAACG,GAAE,GAAI,QAAQF,QAAQ,WAAWD,GAAG,CAACI,MAAM,EAAE;MACrD,CAAC;MACD/C,OAAO,CAACC,GAAG,CAAC,IAAI,CAACZ,WAAW,CAACmD,SAAS;IAC1C,CAAC;EACL;AACJ","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}