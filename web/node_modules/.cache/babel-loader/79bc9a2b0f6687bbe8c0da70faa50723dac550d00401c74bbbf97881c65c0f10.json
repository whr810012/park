{"ast":null,"code":"import \"core-js/modules/es.array.push.js\";\nimport { sendAi, uploadGoods } from '@/api/request';\nexport default {\n  name: 'uploadGoods',\n  data() {\n    return {\n      searchWords: '',\n      loading: false,\n      imageshow: false,\n      showMap: false,\n      form: {\n        name: '',\n        price: '',\n        discount: 1,\n        category: '',\n        condition: '',\n        description: '',\n        image: [],\n        address: \"\",\n        lat: '',\n        lng: ''\n      },\n      options: [{\n        label: '书籍',\n        value: 'book'\n      }, {\n        label: '电子产品',\n        value: 'electronics'\n      }, {\n        label: '食品',\n        value: 'food'\n      }, {\n        label: '衣物',\n        value: 'clothes'\n      }, {\n        label: '家具',\n        value: 'furniture'\n      }, {\n        label: '化妆品',\n        value: 'cosmetics'\n      }, {\n        label: '运动器材',\n        value: 'sports'\n      }, {\n        label: '乐器',\n        value: 'instrument'\n      }, {\n        label: '其他',\n        value: 'other'\n      }],\n      options2: ['全新', '九成新', '八成新', '七成新', '六成新', '五成新', '四成新', '三成新', '二成新', '一成新']\n    };\n  },\n  methods: {\n    sendAi() {\n      this.loading = true;\n      sendAi(this.form).then(res => {\n        console.log('asd', res);\n        this.form.description = res.data.data.message.content;\n        this.loading = false;\n      }).catch(err => {\n        console.log('1111', err);\n        this.loading = false;\n        this.$notify.error(err.data.error);\n      });\n    },\n    handlePictureCardPreview(file) {\n      this.imageshow = true;\n      this.dialogImageUrl = file.url;\n    },\n    handleExceed() {\n      this.$message.warning('最多上传4张图片');\n    },\n    submitForm() {\n      if (!this.form.name) {\n        return this.$message.warning('请填写商品名称');\n      } else if (!this.form.price) {\n        return this.$message.warning('请填写商品价格');\n      } else if (!this.form.category) {\n        return this.$message.warning('请选择商品类别');\n      } else if (!this.form.condition) {\n        return this.$message.warning('请选择商品成色');\n      } else if (!this.form.description) {\n        return this.$message.warning('请填写商品描述');\n      } else if (this.form.image.length === 0) {\n        return this.$message.warning('请上传商品图片');\n      }\n      this.form.uid = this.$store.state.MyInfo.uid;\n      let formData = new FormData();\n      let obj = {\n        ...this.form\n      };\n      Object.keys(obj).forEach(key => {\n        formData.append(key, obj[key]);\n      });\n      // 确保 this.form.image 是一个数组并且存在\n      if (Array.isArray(this.form.image)) {\n        for (let i = 0; i < this.form.image.length; i++) {\n          const file = this.form.image[i].raw; // 假设 raw 是一个有效的 File 对象\n          if (file) {\n            formData.append(`files`, file); // 使用数组形式或不同的字段名\n          }\n        }\n      }\n      uploadGoods(formData).then(() => {\n        this.$message.success('上传成功');\n        this.$router.push('/goods');\n      });\n    }\n  }\n};","map":{"version":3,"names":["sendAi","uploadGoods","name","data","searchWords","loading","imageshow","showMap","form","price","discount","category","condition","description","image","address","lat","lng","options","label","value","options2","methods","then","res","console","log","message","content","catch","err","$notify","error","handlePictureCardPreview","file","dialogImageUrl","url","handleExceed","$message","warning","submitForm","length","uid","$store","state","MyInfo","formData","FormData","obj","Object","keys","forEach","key","append","Array","isArray","i","raw","success","$router","push"],"sources":["C:\\Users\\Administrator\\Desktop\\ershou\\src\\pages\\goods\\uploadGoods.vue"],"sourcesContent":["<template>\r\n    <div class=\"uploadGoods\">\r\n        <div style=\"padding-top: 10px;\">上传商品</div>\r\n        <div class=\"form_box\">\r\n            <el-form :model=\"form\" style=\"padding-left: 20px;padding-top: 10px;\" label-width=\"100px\">\r\n                <el-form-item label=\"名称：\">\r\n                    <el-input style=\"width: 400px;\" placeholder=\"请填写商品名称\" v-model=\"form.name\"></el-input>\r\n                </el-form-item>\r\n                <el-form-item label=\"原价：\">\r\n                    <el-input-number v-model=\"form.price\" style=\"width: 400px;\" min=\"0\" :precision=\"2\"\r\n                        :step=\"0.1\"></el-input-number>\r\n                </el-form-item>\r\n                <el-form-item label=\"折扣：\">\r\n                    <el-input-number v-model=\"form.discount\" style=\"width: 400px;\" :precision=\"2\" :step=\"0.01\" max=\"1\"\r\n                        min=\"0\"></el-input-number>\r\n                    <span v-if=\"form.discount !== 1\" style=\"margin-left: 10px;\">\r\n                        {{ form.discount * 100 / 10 }}折\r\n                    </span>\r\n                </el-form-item>\r\n                <el-form-item label=\"售价：\">\r\n                    <el-input disabled style=\"width: 400px;\"\r\n                        :value=\"(form.price * (form.discount * 100)) / 100\"></el-input>\r\n                </el-form-item>\r\n                <el-form-item label=\"分类：\">\r\n                    <el-select v-model=\"form.category\" placeholder=\"请选择商品分类\" style=\"width: 240px\">\r\n                        <el-option v-for=\"item in options\" :key=\"item.value\" :label=\"item.label\" :value=\"item.value\" />\r\n                    </el-select>\r\n                </el-form-item>\r\n                <el-form-item label=\"成色\">\r\n                    <el-select v-model=\"form.condition\" placeholder=\"请选择商品成色\" style=\"width: 240px\">\r\n                        <el-option v-for=\"item in options2\" :key=\"item\" :label=\"item\" :value=\"item\" />\r\n                    </el-select>\r\n                </el-form-item>\r\n                <el-form-item label=\"商品描述：\">\r\n                    <div style=\"display: flex;\">\r\n                        <el-input type=\"textarea\" v-loading=\"loading\" v-model=\"form.description\" style=\"width: 400px;\"\r\n                            :rows=\"6\" placeholder=\"请填写商品描述\">\r\n                        </el-input>\r\n                        <el-button type=\"primary\" style=\"margin-left: 20px;\" @click=\"sendAi\">\r\n                            一键生成商品描述\r\n                        </el-button>\r\n                    </div>\r\n                </el-form-item>\r\n                <el-form-item label=\"交易地点\">\r\n                    <el-autocomplete width=\"400px\" class=\"inline-input\" v-model=\"searchWords\" :fetch-suggestions=\"fetchSuggestions\"\r\n                        placeholder=\"请输入内容\" :trigger-on-focus=\"false\" @select=\"handleSelect\"></el-autocomplete>\r\n                </el-form-item>\r\n                <el-form-item label=\"图片:\">\r\n                    <el-upload action=\"#\" v-model:file-list=\"form.image\" :auto-upload=\"false\" limit=\"4\"\r\n                        list-type=\"picture-card\" :on-preview=\"handlePictureCardPreview\" :on-exceed=\"handleExceed\"\r\n                        accept=\"image/jpg,image/jpeg,image/png\">\r\n                        <el-icon>\r\n                            <Plus />\r\n                        </el-icon>\r\n                    </el-upload>\r\n                    <el-dialog v-model=\"imageshow\">\r\n                        <img w-full :src=\"dialogImageUrl\" alt=\"Preview Image\" />\r\n                    </el-dialog>\r\n                </el-form-item>\r\n            </el-form>\r\n            <div style=\"text-align: center;\">\r\n                <el-button type=\"primary\" @click=\"submitForm\" style=\"margin-left: 20px;margin-bottom: 40px;\">\r\n                    上传商品\r\n                </el-button>\r\n            </div>\r\n        </div>\r\n    </div>\r\n</template>\r\n\r\n<script>\r\nimport { sendAi, uploadGoods } from '@/api/request'\r\nexport default {\r\n    name: 'uploadGoods',\r\n    data() {\r\n        return {\r\n            searchWords:'',\r\n            loading: false,\r\n            imageshow: false,\r\n            showMap: false,\r\n            form: {\r\n                name: '',\r\n                price: '',\r\n                discount: 1,\r\n                category: '',\r\n                condition: '',\r\n                description: '',\r\n                image: [],\r\n                address: \"\",\r\n                lat: '',\r\n                lng: ''\r\n            },\r\n            options: [\r\n                { label: '书籍', value: 'book' },\r\n                { label: '电子产品', value: 'electronics' },\r\n                { label: '食品', value: 'food' },\r\n                { label: '衣物', value: 'clothes' },\r\n                { label: '家具', value: 'furniture' },\r\n                { label: '化妆品', value: 'cosmetics' },\r\n                { label: '运动器材', value: 'sports' },\r\n                { label: '乐器', value: 'instrument' },\r\n                { label: '其他', value: 'other' }\r\n            ],\r\n            options2: ['全新', '九成新', '八成新', '七成新', '六成新', '五成新', '四成新', '三成新', '二成新', '一成新']\r\n        }\r\n    },\r\n    methods: {\r\n        sendAi() {\r\n            this.loading = true\r\n            sendAi(this.form)\r\n                .then(res => {\r\n                    console.log('asd', res);\r\n                    this.form.description = res.data.data.message.content\r\n                    this.loading = false\r\n                }).catch(err => {\r\n                    console.log('1111', err);\r\n                    this.loading = false\r\n                    this.$notify.error(err.data.error)\r\n                })\r\n        },\r\n        handlePictureCardPreview(file) {\r\n            this.imageshow = true\r\n            this.dialogImageUrl = file.url\r\n        },\r\n        handleExceed() {\r\n            this.$message.warning('最多上传4张图片')\r\n        },\r\n        submitForm() {\r\n            if (!this.form.name) {\r\n                return this.$message.warning('请填写商品名称')\r\n            }\r\n            else if (!this.form.price) {\r\n                return this.$message.warning('请填写商品价格')\r\n            }\r\n            else if (!this.form.category) {\r\n                return this.$message.warning('请选择商品类别')\r\n            }\r\n            else if (!this.form.condition) {\r\n                return this.$message.warning('请选择商品成色')\r\n            }\r\n            else if (!this.form.description) {\r\n                return this.$message.warning('请填写商品描述')\r\n            }\r\n            else if (this.form.image.length === 0) {\r\n                return this.$message.warning('请上传商品图片')\r\n            }\r\n            this.form.uid = this.$store.state.MyInfo.uid\r\n            let formData = new FormData();\r\n            let obj = { ...this.form };\r\n            Object.keys(obj).forEach(key => {\r\n                formData.append(key, obj[key]);\r\n            })\r\n            // 确保 this.form.image 是一个数组并且存在\r\n            if (Array.isArray(this.form.image)) {\r\n                for (let i = 0; i < this.form.image.length; i++) {\r\n                    const file = this.form.image[i].raw; // 假设 raw 是一个有效的 File 对象\r\n                    if (file) {\r\n                        formData.append(`files`, file); // 使用数组形式或不同的字段名\r\n                    }\r\n                }\r\n            }\r\n            uploadGoods(formData).then(() => {\r\n                this.$message.success('上传成功')\r\n                this.$router.push('/goods')\r\n            })\r\n        }\r\n    }\r\n}\r\n</script>\r\n\r\n<style>\r\n.uploadGoods {\r\n    max-width: 100vw;\r\n    padding: 0 0 0 20px;\r\n    background: url('https://img.keaitupian.cn/newupload/08/1629449018344288.jpg') no-repeat;\r\n    background-size: cover;\r\n    max-height: calc(100% - 100px);\r\n}\r\n</style>"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}