{"ast":null,"code":"import { getAllNotice, addNotice, deleteNotice, updateNotice } from '@/api/request';\nimport dayjs from 'dayjs';\nexport default {\n  data() {\n    return {\n      tableData: [],\n      addShow: false,\n      // 新增\n      form: {\n        title: '',\n        content: '',\n        startTime: '',\n        endTime: '',\n        time: []\n      },\n      newForm: {},\n      editShow: false,\n      currPage: 1\n    };\n  },\n  computed: {\n    filterTable() {\n      return this.tableData.filter((item, index) => {\n        return index >= (this.currPage - 1) * 10 && index < this.currPage * 10;\n      });\n    }\n  },\n  methods: {\n    editNotice(item) {\n      this.newForm = {\n        ...item\n      };\n      this.newForm.time = [item.createTime, item.endTime];\n      this.editShow = true;\n    },\n    changeNotice() {\n      this.newForm.startTime = dayjs(this.newForm.time[0]).format('YYYY-MM-DDTHH:mm:ss');\n      this.newForm.endTime = dayjs(this.newForm.time[1]).format('YYYY-MM-DDTHH:mm:ss');\n      const data = {\n        title: this.newForm.title,\n        content: this.newForm.content,\n        createTime: this.newForm.startTime,\n        endTime: this.newForm.endTime,\n        //时间戳+随机整数\n        noticeId: this.newForm.noticeId,\n        createName: this.$store.state.MyInfo.email\n      };\n      updateNotice(data).then(() => {\n        this.$message.success('修改成功');\n        this.closedia();\n        this.init();\n      });\n    },\n    closedia() {\n      this.addShow = false;\n      this.editShow = false;\n      this.newForm = {};\n      this.form = {\n        title: '',\n        content: '',\n        startTime: '',\n        endTime: '',\n        time: []\n      };\n    },\n    openAdd() {\n      this.addShow = true;\n    },\n    addNotice() {\n      this.form.startTime = dayjs(this.form.time[0]).format('YYYY-MM-DDTHH:mm:ss');\n      this.form.endTime = dayjs(this.form.time[1]).format('YYYY-MM-DDTHH:mm:ss');\n      const data = {\n        title: this.form.title,\n        content: this.form.content,\n        createTime: this.form.startTime,\n        endTime: this.form.endTime,\n        //时间戳+随机整数\n        noticeId: Math.floor(Date.now() / 1000) + Math.floor(Math.random() * 1000),\n        createName: this.$store.state.MyInfo.email\n      };\n      addNotice(data).then(() => {\n        this.$message.success('添加成功');\n        this.closedia();\n        this.init();\n      });\n    },\n    deleteNotice(row) {\n      this.$confirm('此操作将永久删除该公告, 是否继续?', '提示', {\n        confirmButtonText: '确定',\n        cancelButtonText: '取消',\n        type: 'warning'\n      }).then(() => {\n        deleteNotice([row.noticeId]).then(() => {\n          this.$message.success('删除成功');\n          this.init();\n        });\n      });\n    },\n    init() {\n      getAllNotice().then(res => {\n        this.tableData = res.data.data;\n        this.tableData.forEach(item => {\n          item.createTime = dayjs(item.createTime).format('YYYY-MM-DD HH:mm:ss');\n          item.endTime = dayjs(item.endTime).format('YYYY-MM-DD HH:mm:ss');\n        });\n      });\n    }\n  },\n  created() {\n    this.init();\n  }\n};","map":{"version":3,"names":["getAllNotice","addNotice","deleteNotice","updateNotice","dayjs","data","tableData","addShow","form","title","content","startTime","endTime","time","newForm","editShow","currPage","computed","filterTable","filter","item","index","methods","editNotice","createTime","changeNotice","format","noticeId","createName","$store","state","MyInfo","email","then","$message","success","closedia","init","openAdd","Math","floor","Date","now","random","row","$confirm","confirmButtonText","cancelButtonText","type","res","forEach","created"],"sources":["D:\\CODE\\park\\park-vue\\web\\src\\pages\\home\\noticeManage.vue"],"sourcesContent":["<template>\r\n  <div class=\"area-manage\" style=\"padding: 20px\">\r\n    <el-button type=\"primary\" @click=\"openAdd\">新增公告</el-button>\r\n    <el-table :data=\"filterTable\" style=\"width: 100%; margin-top: 20px\" border>\r\n      <el-table-column type=\"index\" label=\"序号\" width=\"70\" align=\"center\"></el-table-column>\r\n      <el-table-column align=\"center\" prop=\"noticeId\" label=\"公告编号\"></el-table-column>\r\n      <el-table-column align=\"center\" prop=\"createName\" label=\"创建人\"></el-table-column>\r\n      <el-table-column align=\"center\" prop=\"createTime\" label=\"开始时间\"></el-table-column>\r\n      <el-table-column align=\"center\" prop=\"endTime\" label=\"结束时间\"></el-table-column>\r\n      <el-table-column align=\"center\" prop=\"title\" label=\"标题\"></el-table-column>\r\n      <el-table-column align=\"center\" prop=\"content\" label=\"内容\">\r\n        <template #default=\"scope\">\r\n          <el-popover placement=\"top-start\" trigger=\"hover\" :content=\"scope.row.content\">\r\n            <template #reference>\r\n              <div class=\"content\">\r\n                {{ scope.row.content }}\r\n              </div>\r\n            </template>\r\n          </el-popover>\r\n        </template>\r\n      </el-table-column>\r\n      <el-table-column align=\"center\" label=\"操作\" width=\"150\">\r\n        <template #default=\"scope\">\r\n          <el-button type=\"text\" size=\"small\" @click=\"editNotice(scope.row)\">编辑</el-button>\r\n          <el-button type=\"text\" size=\"small\" @click=\"deleteNotice(scope.row)\">删除</el-button>\r\n        </template>\r\n      </el-table-column>\r\n    </el-table>\r\n    <el-pagination style=\"margin-top: 20px;\" background layout=\"prev, pager, next\" :total=\"tableData.length\"\r\n      v-model:current-page=\"currPage\"></el-pagination>\r\n    <el-dialog v-if=\"addShow\" v-model=\"addShow\" title=\"新增公告\" center @close=\"closedia\">\r\n      <el-form :data=\"form\" label-width=\"80px\" label-position=\"right\">\r\n        <el-form-item name=\"title\" label=\"标题:\">\r\n          <el-input v-model=\"form.title\"></el-input>\r\n        </el-form-item>\r\n        <el-form-item name=\"content\" label=\"内容:\">\r\n          <el-input type=\"textarea\" v-model=\"form.content\"></el-input>\r\n        </el-form-item>\r\n        <el-form-item name=\"time\" label=\"时间范围:\">\r\n          <el-date-picker v-model=\"form.time\" value-format=\"YYYY-MM-DDTHH:mm:ss\" type=\"datetimerange\"\r\n            range-separator=\"至\" start-placeholder=\"开始日期\" end-placeholder=\"结束日期\">\r\n          </el-date-picker>\r\n        </el-form-item>\r\n        <div>\r\n          <el-button type=\"primary\" @click=\"closedia\">取消</el-button>\r\n          <el-button type=\"primary\" @click=\"addNotice\">确定</el-button>\r\n        </div>\r\n      </el-form>\r\n    </el-dialog>\r\n    <el-dialog v-if=\"editShow\" v-model=\"editShow\" title=\"编辑公告\" center @close=\"closedia\">\r\n      <el-form :data=\"newForm\" label-width=\"80px\" label-position=\"right\">\r\n        <el-form-item name=\"title\" label=\"标题:\">\r\n          <el-input v-model=\"newForm.title\"></el-input>\r\n        </el-form-item>\r\n        <el-form-item name=\"content\" label=\"内容:\">\r\n          <el-input type=\"textarea\" v-model=\"newForm.content\"></el-input>\r\n        </el-form-item>\r\n        <el-form-item name=\"time\" label=\"时间范围:\">\r\n          <el-date-picker v-model=\"newForm.time\" type=\"datetimerange\" value-format=\"YYYY-MM-DD HH:mm:ss\"\r\n            range-separator=\"至\" start-placeholder=\"开始日期\" end-placeholder=\"结束日期\">\r\n          </el-date-picker>\r\n        </el-form-item>\r\n        <div>\r\n          <el-button type=\"primary\" @click=\"closedia\">取消</el-button>\r\n          <el-button type=\"primary\" @click=\"changeNotice\">确定</el-button>\r\n        </div>\r\n      </el-form>\r\n    </el-dialog>\r\n  </div>\r\n</template>\r\n\r\n<script>\r\nimport { getAllNotice, addNotice, deleteNotice, updateNotice } from '@/api/request'\r\nimport dayjs from 'dayjs'\r\nexport default {\r\n  data() {\r\n    return {\r\n      tableData: [\r\n      ],\r\n      addShow: false,\r\n      // 新增\r\n      form: {\r\n        title: '',\r\n        content: '',\r\n        startTime: '',\r\n        endTime: '',\r\n        time: []\r\n      },\r\n      newForm:{},\r\n      editShow: false,\r\n      currPage: 1\r\n    }\r\n  },\r\n  computed: {\r\n    filterTable() {\r\n      return this.tableData.filter((item, index) => {\r\n        return index >= (this.currPage - 1) * 10 && index < this.currPage * 10\r\n      })\r\n    }\r\n  },\r\n  methods: {\r\n    editNotice (item) {\r\n      this.newForm = {...item}\r\n      this.newForm.time = [item.createTime, item.endTime]\r\n      this.editShow = true\r\n    },\r\n    changeNotice() {\r\n      this.newForm.startTime = dayjs(this.newForm.time[0]).format('YYYY-MM-DDTHH:mm:ss')\r\n      this.newForm.endTime = dayjs(this.newForm.time[1]).format('YYYY-MM-DDTHH:mm:ss')\r\n      const data = {\r\n        title: this.newForm.title,\r\n        content: this.newForm.content,\r\n        createTime: this.newForm.startTime,\r\n        endTime: this.newForm.endTime,\r\n        //时间戳+随机整数\r\n        noticeId: this.newForm.noticeId,\r\n        createName: this.$store.state.MyInfo.email\r\n      }\r\n      updateNotice(data).then(() => {\r\n        this.$message.success('修改成功')\r\n        this.closedia()\r\n        this.init()\r\n      })\r\n    },\r\n    closedia() {\r\n      this.addShow = false\r\n      this.editShow = false\r\n      this.newForm = {}\r\n      this.form = {\r\n        title: '',\r\n        content: '',\r\n        startTime: '',\r\n        endTime: '',\r\n        time: []\r\n      }\r\n    },\r\n    openAdd() {\r\n      this.addShow = true\r\n    },\r\n    addNotice() {\r\n      this.form.startTime = dayjs(this.form.time[0]).format('YYYY-MM-DDTHH:mm:ss')\r\n      this.form.endTime = dayjs(this.form.time[1]).format('YYYY-MM-DDTHH:mm:ss')\r\n      const data = {\r\n        title: this.form.title,\r\n        content: this.form.content,\r\n        createTime: this.form.startTime,\r\n        endTime: this.form.endTime,\r\n        //时间戳+随机整数\r\n        noticeId: Math.floor(Date.now() / 1000) + Math.floor(Math.random() * 1000),\r\n        createName: this.$store.state.MyInfo.email\r\n      }\r\n      addNotice(data).then(() => {\r\n        this.$message.success('添加成功')\r\n        this.closedia()\r\n        this.init()\r\n      })\r\n    },\r\n    deleteNotice(row) {\r\n      this.$confirm('此操作将永久删除该公告, 是否继续?', '提示', {\r\n        confirmButtonText: '确定',\r\n        cancelButtonText: '取消',\r\n        type: 'warning'\r\n      }).then(() => {\r\n        deleteNotice([row.noticeId]).then(() => {\r\n          this.$message.success('删除成功')\r\n          this.init()\r\n        })\r\n      })\r\n    },\r\n    init() {\r\n      getAllNotice().then(res => {\r\n        this.tableData = res.data.data\r\n        this.tableData.forEach(item => {\r\n          item.createTime = dayjs(item.createTime).format('YYYY-MM-DD HH:mm:ss')\r\n          item.endTime = dayjs(item.endTime).format('YYYY-MM-DD HH:mm:ss')\r\n        })\r\n      })\r\n    }\r\n  },\r\n  created() {\r\n    this.init()\r\n  }\r\n}\r\n</script>\r\n\r\n<style lang=\"scss\" scoped>\r\n.content {\r\n  display: -webkit-box;\r\n  -webkit-box-orient: vertical;\r\n  -webkit-line-clamp: 1;\r\n  overflow: hidden;\r\n  text-overflow: ellipsis;\r\n  white-space: nowrap;\r\n}\r\n</style>"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}